#include <stdio.h>
#include <time.h>

double bef(int, int, int, int, int, int, int, int, int, int, double, double);
double aft(int, int, int, int, int, int, int, int, int, int, int, double, double);

int max_d[31] = {
    21, 20, 19, 18, 17, 12, 15, 14, 13, 12, 7, 10,
    9, 8, 7, 6, 5, 4, 3, 2, 1, 11, 10, 4, 8, 7,
    6, 5, 3, 2, 0
};
int move[31][6] = {
    {0, 1, 2, 3, 4, 5},   {0, 2, 3, 4, 5, 6},   {0, 3, 4, 5, 6, 7},
    {0, 4, 5, 6, 7, 8},   {0, 5, 6, 7, 8, 9},   {0, 21, 22, 23, 24, 25},
    {0, 7, 8, 9, 10, 11}, {0, 8, 9, 10, 11, 12},{0, 9, 10, 11, 12, 13},
    {0, 10, 11, 12, 13, 14}, {0, 26, 27, 23, 28, 29}, {0, 12, 13, 14, 15, 16},
    {0, 13, 14, 15, 16, 17}, {0, 14, 15, 16, 17, 18}, {0, 15, 16, 17, 18, 19},
    {0, 16, 17, 18, 19, 20}, {0, 17, 18, 19, 20, 30}, {0, 18, 19, 20, 30, 30},
    {0, 19, 20, 30, 30, 30}, {0, 20, 30, 30, 30, 30}, {0, 30, 30, 30, 30, 30},
    {0, 22, 23, 24, 25, 15}, {0, 23, 24, 25, 15, 16}, {0, 28, 29, 20, 30, 30},
    {0, 25, 15, 16, 17, 18}, {0, 15, 16, 17, 18, 19}, {0, 27, 23, 28, 29, 20},
    {0, 23, 28, 29, 20, 30}, {0, 29, 20, 30, 30, 30}, {0, 20, 30, 30, 30, 30},
    {0, 30, 30, 30, 30, 30}
};
double table[31][31] = {
    {0.5086941698944316, 0.5096222996051765, 0.5428363906917196, 0.5270681316941366, 0.47893256675041623, 0.21497497660916004, 0.39876119414929756, 0.3281417362374514, 0.27264838532520635, 0.2555535086534219, 0.07563617558878503, 0.19277744696254479, 0.14529056838493834, 0.10276703477631785, 0.0685289822838259, 0.044030770377956274, 0.02577177244881515, 0.014034792297729151, 0.006532287827176034, 0.0024186909006039584, 0.0005782375573205116, 0.1531598511000952, 0.15276804305745922, 0.021850815070906922, 0.10454353735749249, 0.06967313382323574, 0.04563131847465245, 0.0261306359812343, 0.006889794989432272, 0.002203668345103288, 0.0},
    {0.5323256044268334, 0.0, 0.5150225702461722, 0.5743811937579792, 0.5777438660998035, 0.24903445554608136, 0.45192690087053655, 0.36271403393624985, 0.3170823495405969, 0.30226922640242454, 0.09144909355222577, 0.2287377253597007, 0.17473554226591018, 0.12700610400238008, 0.08792635911309474, 0.05943108379200016, 0.036554190105880305, 0.021287478112367763, 0.010691636198311299, 0.0043219231695055685, 0.0013996369101745526, 0.1780752518031743, 0.1853643684031897, 0.036978571479317456, 0.13073159889582567, 0.090315359621957, 0.05506589386977801, 0.03467746714610479, 0.01167621439398696, 0.004064873467192674, 0.0},
    {0.620073289423182, 0.5588435402598536, 0.0, 0.5342844803839336, 0.6136951051798926, 0.41848001303268806, 0.5218802546929373, 0.4333510904166589, 0.385835800426373, 0.3852515016720646, 0.14616579101932037, 0.2964368230476473, 0.23230600706733362, 0.17666930928564728, 0.1261095180289391, 0.08060306392781412, 0.04532446257902742, 0.02195849049262874, 0.008690694841602929, 0.0026591252762966553, 0.0009973441520648011, 0.2599391968213197, 0.24277680834812657, 0.023449842828832407, 0.17658186214663946, 0.12483105576595957, 0.10041928078774462, 0.05824587627875894, 0.008600176435032147, 0.002674405717582258, 0.0},
    {0.6820564319744971, 0.6291337194063028, 0.5302497029547523, 0.0, 0.5597851257230292, 0.49302329240863363, 0.6228055502676317, 0.5000865557603074, 0.43560038169452264, 0.42294698162911953, 0.18887702179808397, 0.3448379609049286, 0.27540821686239814, 0.21313705002098637, 0.1559563009992886, 0.10322067592403025, 0.059759334863344095, 0.030436240321936918, 0.012730654395553527, 0.0039050188675319735, 0.0004913090325660202, 0.30832087191792285, 0.2888820289776296, 0.030876224894552287, 0.21198710907392018, 0.1536428084637878, 0.13224372880861135, 0.07707962677635029, 0.012137059135255715, 0.0035074421331839694, 0.0},
    {0.6938350087385177, 0.6533864860366027, 0.563763607498747, 0.4860625491217847, 0.0, 0.40890678198213076, 0.6339230950287462, 0.5926454908351648, 0.47098270163160133, 0.4369963639036462, 0.1790587505699479, 0.35552871534251757, 0.2842390526461671, 0.21294879814545958, 0.15071106460086403, 0.10043742253511778, 0.060379928922754345, 0.031719334023966664, 0.013431622929708497, 0.004326877937178317, 0.000980894067993774, 0.2855050653981525, 0.27747958211716595, 0.03070988871867788, 0.2069573495340512, 0.14781268748576637, 0.11843134830585397, 0.06927325150098976, 0.0126161423982627, 0.0037985519065672395, 0.0},
    {0.9005971163129591, 0.877351976735736, 0.840964503561852, 0.8094182952690103, 0.8186551157075985, 0.0, 0.7889049919460852, 0.731515620889223, 0.681776595495069, 0.6791565365525876, 0.35088272025751543, 0.6473986929463406, 0.5827563615598423, 0.497751890754321, 0.419073454790162, 0.3597741187094832, 0.26506731867201055, 0.1800112057342172, 0.09951984048772554, 0.04201823048277606, 0.011051623632221577, 0.5825097576710532, 0.7345005206930227, 0.35783760090055017, 0.5518181929239677, 0.45013131819736896, 0.28426867391426713, 0.23855705257917875, 0.10982121476432186, 0.038219227270790655, 0.0},
    {0.7498264255353077, 0.7107950372774114, 0.6433675538704486, 0.5972144983347273, 0.5610629560052198, 0.3555954539093209, 0.0, 0.5312984404111595, 0.6378102229802483, 0.63224339504654, 0.2175187495579179, 0.43382794427900767, 0.33555724050608693, 0.26814703644150983, 0.20169832818535638, 0.13821859368772765, 0.08793810028974489, 0.05328162949740254, 0.028903889462994138, 0.013557040760305096, 0.010271707054575585, 0.30178286864739595, 0.3066602293094673, 0.07070821329849078, 0.257903455122784, 0.19607310240857484, 0.13070449091499656, 0.10135468330160213, 0.03272525874967851, 0.015030682673123977, 0.0},
    {0.8158157080950355, 0.7820046329240915, 0.7160662094171043, 0.6754047022768213, 0.6656994457479857, 0.4490158412071733, 0.5411814667182916, 0.0, 0.564020171029084, 0.682433200097159, 0.4155726582879108, 0.5174453660448991, 0.4254427557866575, 0.34744465114937506, 0.27973831408345634, 0.19433056890480996, 0.11907084096734105, 0.07349109660798714, 0.04033324074170453, 0.01641742660458095, 0.0027679813952005026, 0.3985562558519988, 0.39132375676318987, 0.07310282828661746, 0.3300136382079298, 0.26186776069212553, 0.2144496142092201, 0.12934844418331795, 0.037533948331339606, 0.013960134879081956, 0.0},
    {0.8555627441763662, 0.8274253640109155, 0.7666890106214043, 0.7259007098497349, 0.72380016027012, 0.49447710776596154, 0.6406638959671737, 0.5251642370103906, 0.0, 0.5854036093480649, 0.5008470378010063, 0.6595341483276937, 0.5168261541387611, 0.41513142809415327, 0.32315827996008856, 0.2486508406734506, 0.16261270542176465, 0.09892166278198104, 0.0518285799427578, 0.021881992788482026, 0.005716326960276999, 0.45688207467453107, 0.4604805770035013, 0.09620114198977123, 0.37907482662421527, 0.30542612640847283, 0.2626288250325098, 0.16586848530821335, 0.04900815164065878, 0.017669068242814626, 0.0},
    {0.8663398350147211, 0.8396371400547543, 0.7844835808366741, 0.7429245803249103, 0.7386322409789383, 0.48185372154791317, 0.6827054559102292, 0.5788415879428711, 0.47665418923259134, 0.0, 0.40686010157578556, 0.6876172437028528, 0.6452842575178949, 0.4734372224530244, 0.35312328884379884, 0.25930552953984376, 0.19086327335549527, 0.11848632027689286, 0.05688520530984273, 0.022548489151614483, 0.011051623632221577, 0.4455858280834815, 0.46814901329875763, 0.09608316488925583, 0.41152798784829986, 0.3220654254365919, 0.2440350484439561, 0.16132686688153808, 0.04856026400402949, 0.01874948593962908, 0.0},
    {0.9743382854478042, 0.9647406529883694, 0.9504409469357458, 0.9346315753373624, 0.9404485780127445, 0.747103403627121, 0.9138215658590165, 0.8854829781789793, 0.8549539886400896, 0.8603413174279402, 0.0, 0.8297289769488942, 0.7723865853884313, 0.6974163432632483, 0.6257020981944038, 0.5434524665920131, 0.4309373386920714, 0.3239022873806618, 0.20673435389804196, 0.11619083914519951, 0.11192780528957441, 0.7116826392456987, 0.7461327933804435, 0.574594591195562, 0.6974163432632483, 0.6257020981944038, 0.575122167470169, 0.6715986768346527, 0.2762334027356417, 0.13971556892005788, 0.0},
    {0.9102160532039183, 0.8887449191978891, 0.8471123588457932, 0.8151151337935707, 0.8147492338339527, 0.555019535456458, 0.7666059027182022, 0.6938601075148549, 0.6346407469590329, 0.5758351402407377, 0.36698081903499413, 0.0, 0.5578890018880243, 0.676859288856994, 0.6058783094652681, 0.39256322819693085, 0.2578387353124108, 0.17985012633502212, 0.11922668862424138, 0.05442297260355747, 0.0168493691782144, 0.4794421868211214, 0.46904514789931695, 0.138233760262942, 0.5388000487501946, 0.48024389168915754, 0.2778225968412411, 0.19004435561349659, 0.08750738364342567, 0.04266006451945791, 0.0},
    {0.9396407715974435, 0.9225125719216859, 0.8919444402098534, 0.8663128807839263, 0.8690253892325366, 0.6268007837899838, 0.8260783324682576, 0.7634079955636927, 0.7161758142644894, 0.6890835118964679, 0.4437850521029609, 0.5090966339616368, 0.0, 0.5619705303727819, 0.6834016353761639, 0.596004799881848, 0.36426157206543747, 0.2389761939433283, 0.14360178643384375, 0.08618283783954447, 0.02982207079936, 0.5507600080884257, 0.5199061867392817, 0.19463732961680255, 0.5063471422067929, 0.5228687682178006, 0.3501810966940095, 0.25773607694050266, 0.1200778724848265, 0.05364013805914502, 0.0},
    {0.9615847334377549, 0.9484950149457271, 0.9302082796036484, 0.9112751454890491, 0.9131785706700144, 0.6979458519005205, 0.8794500607807947, 0.8332367137895361, 0.7908316245996988, 0.7720644010164895, 0.5293371415959344, 0.6475277404723833, 0.5228081433096249, 0.0, 0.5720378723612545, 0.6892374434572738, 0.5869040176277706, 0.3377254988434894, 0.18434512609122577, 0.09663700551365094, 0.07103452451230721, 0.6410192559989175, 0.6140131240793523, 0.25449576448292016, 0.4635117956274604, 0.48087105891329496, 0.44683889212763195, 0.35343343149544976, 0.14488559563366718, 0.06434633511000756, 0.0},
    {0.9770683723310801, 0.9676697427707469, 0.9598232966274527, 0.9472661580346445, 0.9472222537971595, 0.7728685904195403, 0.9222841971294405, 0.8933614245058681, 0.8582345978114313, 0.8396370657461764, 0.6257020981944038, 0.7682387695910977, 0.6678375775978784, 0.5353269441645551, 0.0, 0.5756332695443324, 0.6722312298099344, 0.5745914230036694, 0.2762295587097472, 0.13971556892005788, 0.11192780528957441, 0.7277726452696787, 0.7174081820495606, 0.3239022873806618, 0.5353269441645551, 0.45655185120141584, 0.5434524665920131, 0.4309373386920714, 0.20673435389804196, 0.11619083914519951, 0.0},
    {0.9874827367835632, 0.9813109354413302, 0.9798055359269444, 0.9724706059052498, 0.9716532609239688, 0.8485959758668704, 0.9532276465134933, 0.9360229421918678, 0.9140703672459829, 0.8993272125443739, 0.7275847595107936, 0.8443620016067159, 0.792803467198957, 0.696893838561177, 0.5639096664045352, 0.0, 0.5652862132590446, 0.701618067217552, 0.5365299911495945, 0.2162960230966814, 0.12980512, 0.8076684384748893, 0.8033626771418728, 0.4403168827894182, 0.696893838561177, 0.5639096664045352, 0.6337722105911232, 0.5047586668656519, 0.3270995400049145, 0.1984290457210454, 0.0},
    {0.9939301147284504, 0.9903139829913031, 0.9913954533938779, 0.9877564099225253, 0.9871049087793313, 0.9131355337622659, 0.9741691670753811, 0.9648601405595942, 0.953674451399242, 0.9474959182371073, 0.8217002754680894, 0.9022795495691601, 0.8716226037665075, 0.8327482456415521, 0.7364498469469943, 0.5911878723590224, 0.0, 0.645380870213767, 0.6633232555100176, 0.4995201275610551, 0.12980512, 0.8806206544277312, 0.8729044578335222, 0.6102906312396228, 0.8327482456415521, 0.7364498469469943, 0.7288363748683837, 0.6181750501908904, 0.4728931732486319, 0.27073688564104764, 0.0},
    {0.9975636427170851, 0.9957465644151321, 0.9968994049654581, 0.995735387112132, 0.9952899834294399, 0.960318552707767, 0.9859279947607451, 0.9846401459890674, 0.9793459980789184, 0.9764903012790866, 0.8810900814286587, 0.9499030427575846, 0.9292616622335855, 0.9048846152003333, 0.8577697929741642, 0.7695118087058029, 0.638000148682509, 0.0, 0.5378831281621395, 0.5348851996646248, 0.41953888000000006, 0.943778887104637, 0.9356946034513801, 0.6895769303701741, 0.9048846152003333, 0.8577697929741642, 0.8201583025350919, 0.7627363363237992, 0.47122170500552185, 0.24255105721128187, 0.0},
    {0.9992774080679484, 0.9985731668959962, 0.9990716980610493, 0.9989970961900186, 0.9987271502091667, 0.9870743643767063, 0.9933469459369745, 0.9955235564375783, 0.9932831317523944, 0.9911677949398797, 0.93413397598959, 0.9823199054874202, 0.9708398350825377, 0.9533844072669057, 0.9291880012992805, 0.9064688290084174, 0.8469221619149858, 0.7322229171905624, 0.0, 0.6297590800035797, 0.78975424, 0.9818590146820044, 0.9786980520115801, 0.7936849311446138, 0.9533844072669057, 0.9291880012992805, 0.9102252852456608, 0.8950228684877216, 0.6101210269381555, 0.4637421595979776, 0.0},
    {0.9998784280053007, 0.9997057322740964, 0.9997903126207676, 0.9998967043590533, 0.9997937711811952, 0.9976764429902095, 0.9978404171438134, 0.9994180436479002, 0.998798166493828, 0.9976764429902095, 0.9764676535117615, 0.9964574915716057, 0.9937300360600149, 0.9850652924076714, 0.9764676535117615, 0.9727090238937087, 0.9727090238937087, 0.9117937293248511, 0.8339575195979776, 0.0, 1.0, 0.9967770899528613, 0.9964574915716057, 0.9117937293248511, 0.9850652924076714, 0.9764676535117615, 0.9727090238937087, 0.9727090238937087, 0.8339575195979776, 0.78975424, 0.0},
    {1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0},
    {0.926991523058296, 0.9058746801171772, 0.8847935407160782, 0.8606964987480369, 0.8645723567408844, 0.5271248841822935, 0.8259229528296277, 0.7831138748075346, 0.7418381428350822, 0.7286253102966702, 0.384315908214623, 0.6674250109678218, 0.6344072478324446, 0.5893102324936357, 0.5084166280149128, 0.42952606225661266, 0.30192681215623574, 0.23627393423354653, 0.14187661103738516, 0.05929185494421263, 0.015329251097090674, 0.0, 0.6164710794276902, 0.4500994868980723, 0.7179588051906818, 0.55267643929582, 0.2919117182511503, 0.25633286105224096, 0.14685746536226021, 0.056491547947083685, 0.0},
    {0.9351795500834859, 0.9156363286829845, 0.8914262697793215, 0.8676229709819038, 0.8711105495901015, 0.573293064165388, 0.8277114366894811, 0.7795690147090786, 0.7415616835282831, 0.7232206024723253, 0.40856574717598954, 0.6147126392119541, 0.5967620243265427, 0.6023076679656891, 0.5525548281716969, 0.4666720380259185, 0.31278267448862473, 0.23024282494604126, 0.15647275604039718, 0.07164973368468508, 0.0168493691782144, 0.4577408728988361, 0.0, 0.33666861899191497, 0.7331817724416416, 0.6781892459478074, 0.30658692992159176, 0.24338454802252169, 0.13911407295174766, 0.05988682560058553, 0.0},
    {0.9975680830048439, 0.9956347247721825, 0.9969127790225699, 0.9960073770126, 0.9956570291651591, 0.9595591817857059, 0.9845790031995602, 0.9861384124901273, 0.9814986705481458, 0.9796470342326491, 0.8577689847840186, 0.9609267013909499, 0.9462552727145438, 0.925135316338752, 0.8810900814286587, 0.8201583025350919, 0.7627363363237992, 0.6895769303701741, 0.47122170500552185, 0.24255105721128187, 0.41953888000000006, 0.9437684002647069, 0.9436990022209543, 0.0, 0.925135316338752, 0.8810900814286587, 0.7695090548727139, 0.6379966298957843, 0.5378926328642801, 0.5348851996646248, 0.0},
    {0.9613441804277966, 0.9479927377181009, 0.9304770708737599, 0.9117615474854297, 0.9137879421693447, 0.6914160678044962, 0.8806327406494057, 0.836993921868917, 0.794559734699595, 0.7785941851125139, 0.5293371415959344, 0.6739418441198791, 0.556559497970314, 0.4635117956274604, 0.48087105891329496, 0.6892374434572738, 0.5869040176277706, 0.3377254988434894, 0.18434512609122577, 0.09663700551365094, 0.07103452451230721, 0.6317138183387067, 0.5875990204318564, 0.25449576448292016, 0.0, 0.5720378723612545, 0.44683889212763195, 0.35343343149544976, 0.14488559563366718, 0.06434633511000756, 0.0},
    {0.9770683723310801, 0.9676697427707469, 0.9598232966274527, 0.9472661580346445, 0.9472222537971595, 0.7728685904195403, 0.9222841971294405, 0.8933614245058681, 0.8582345978114313, 0.8396370657461764, 0.6257020981944038, 0.7682387695910977, 0.6678375775978784, 0.5353269441645551, 0.45655185120141584, 0.5756332695443324, 0.6722312298099344, 0.5745914230036694, 0.2762295587097472, 0.13971556892005788, 0.11192780528957441, 0.7277726452696787, 0.7174081820495606, 0.3239022873806618, 0.5353269441645551, 0.0, 0.5434524665920131, 0.4309373386920714, 0.20673435389804196, 0.11619083914519951, 0.0},
    {0.9844100936683657, 0.9756111591640315, 0.9765629681796204, 0.968838183508317, 0.970393461957263, 0.7853509281030283, 0.9428480981342927, 0.9348169121045132, 0.9152102052106168, 0.9162431255544424, 0.5640403713281856, 0.883212653934188, 0.8384306015378763, 0.7882257235765178, 0.7275847595107936, 0.6337722105911232, 0.5047586668656519, 0.4403168827894182, 0.3270995400049145, 0.1984290457210454, 0.12980512, 0.7366497477676969, 0.7835822718472585, 0.7016176970571835, 0.7882257235765178, 0.7275847595107936, 0.0, 0.5649220985317556, 0.5365430893119019, 0.2162960230966814, 0.0},
    {0.9922167737310391, 0.9867249671467356, 0.991110986933292, 0.987998854516784, 0.9877721176805973, 0.8730352606610158, 0.9686636083014603, 0.9666900737463987, 0.9565112217092243, 0.9563888072953505, 0.7364477577306517, 0.926180299582586, 0.8990822950335454, 0.8742111660195324, 0.8217002754680894, 0.7288363748683837, 0.6181750501908904, 0.6102906312396228, 0.4728931732486319, 0.27073688564104764, 0.12980512, 0.8346320932987993, 0.860363448577275, 0.6453782849787167, 0.8742111660195324, 0.8217002754680894, 0.5911831010427965, 0.0, 0.6633399920507436, 0.4995201275610551, 0.0},
    {0.999322615648547, 0.9986272105060167, 0.9990684854130579, 0.99908068501269, 0.9988382285170002, 0.9878730886942525, 0.9930371189730459, 0.9960401916039475, 0.994168881275321, 0.991966519257426, 0.9291880012992805, 0.9847930070373719, 0.9776817997303197, 0.960173383806829, 0.93413397598959, 0.9102252852456608, 0.8950228684877216, 0.7936849311446138, 0.6101210269381555, 0.4637421595979776, 0.78975424, 0.9824477673548492, 0.9811711535615318, 0.7322229171905624, 0.960173383806829, 0.93413397598959, 0.9064688290084174, 0.8469221619149858, 0.0, 0.6297590800035797, 0.0},
    {0.9998784280053007, 0.9997057322740964, 0.9997903126207676, 0.9998967043590533, 0.9997937711811952, 0.9976764429902095, 0.9978404171438134, 0.9994180436479002, 0.998798166493828, 0.9976764429902095, 0.9764676535117615, 0.9964574915716057, 0.9937300360600149, 0.9850652924076714, 0.9764676535117615, 0.9727090238937087, 0.9727090238937087, 0.9117937293248511, 0.8339575195979776, 0.78975424, 1.0, 0.9967770899528613, 0.9964574915716057, 0.9117937293248511, 0.9850652924076714, 0.9764676535117615, 0.9727090238937087, 0.9727090238937087, 0.8339575195979776, 0.0, 0.0},
    {1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0},
};
double ps[6] = {0.0, 0.21024576, 0.37021536, 0.2973376, 0.08503056, 0.04477456};
FILE *data, *res;
int a, b, c, d, e, f, g, h, i;
double x;
clock_t st, en;

double clip(double x) {
    if (x < 0.0) return 0.0;
    if (x > 100.0) return 100.0;
    return x;
}

double ev(int w1, int w2, int w3, int w4, int b1, int b2, int b3, int b4, int turn) {
    int wh[4] = {w1, w2, w3, w4};
    int bl[4] = {b1, b2, b3, b4};
    double fac[6] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0};

    // 척도1: 최대 거리합
    for (int i = 0; i < 4; i++) {
        fac[0] += max_d[wh[i]];
        fac[0] -= max_d[bl[i]];
    }
    fac[0] *= -0.226;

    // 척도2: 업힌 말 수
    for (int i = 1; i < 30; i++) {
        int wc = 0, bc = 0;
        for (int j = 0; j < 4; j++) {
            if (wh[j] == i) wc++;
            if (bl[j] == i) bc++;
        }
        if (wc >= 2) fac[1] += wc;
        if (bc >= 2) fac[1] -= bc;
    }
    fac[1] *= 0.984;

    // 척도3: 잡을 수 있는 상대 말 수
    for (int i = 0; i < 4; i++) {
        for (int j = 0; j < 4; j++) {
            if (bl[j] == move[wh[i]][2] || bl[j] == move[wh[i]][3])
                fac[2] += 1;
            if (wh[i] == move[bl[j]][2] || wh[i] == move[bl[j]][3])
                fac[2] -= 1;
        }
    }
    fac[2] *= 0.293;

    // 척도4: 업을 수 있는 우리 말 수
    for (int i = 0; i < 4; i++) {
        for (int j = 0; j < 4; j++) {
            if (wh[i] == move[wh[j]][2] || wh[i] == move[wh[i]][3])
                fac[3] += 1;
            if (bl[i] == move[bl[j]][2] || bl[i] == move[bl[i]][3])
                fac[3] -= 1;
        }
    }
    fac[3] *= 0.193;

    // 척도5: 차례
    fac[4] = (turn ? -1 : 1);

    // 척도6: 난 말 수
    for (int i = 0; i < 4; i++) {
        if (wh[i] == 30) fac[5]++;
        if (bl[i] == 30) fac[5]--;
    }
    fac[5] *= 0.740;

    double sum = 0.0;
    for (int i = 0; i < 6; i++) {
        sum += fac[i];
    }
    return clip(2.868 * sum + 50.26);
}

int not_finished(int a, int b, int c, int d) {
    if(a != 30) return a;
    if(b != 30) return b;
    if(c != 30) return c;
    if(d != 30) return d;
    return 0;
}

int num_finish(int a, int b, int c, int d) {
    int x = 0;
    if(a == 30) x++;
    if(b == 30) x++;
    if(c == 30) x++;
    if(d == 30) x++;
    return x;
}

double bef(int w1, int w2, int w3, int w4, int b1, int b2, int b3, int b4, int turn, int d, double alpha, double beta) {
    int tu = turn;
    if (w1 + w2 + w3 + w4 == 120) return 100.0;
    if (b1 + b2 + b3 + b4 == 120) return 0.0;
    if (d == 0) {
        return ev(w1, w2, w3, w4, b1, b2, b3, b4, turn);
    }
    if (num_finish(w1, w2, w3, w4) == 3 && num_finish(b1, b2, b3, b4) == 3) {
        return table[not_finished(w1, w2, w3, w4)][not_finished(b1, b2, b3, b4)];
    }

    double res = 0.0;
    for (int r = 1; r <= 5; r++) {
        res += aft(w1, w2, w3, w4, b1, b2, b3, b4, r, turn, d - 1, alpha, beta) * ps[r];
    }
    return clip(res);
}

double aft(int w1, int w2, int w3, int w4, int b1, int b2, int b3, int b4, int r, int turn, int d, double alpha, double beta) {
    if (w1 + w2 + w3 + w4 == 120) return 100.0;
    if (b1 + b2 + b3 + b4 == 120) return 0.0;
    if (d == 0) return ev(w1, w2, w3, w4, b1, b2, b3, b4, turn);

    int wh[4], bl[4], ori, moved, caught;
    double cur, res = turn ? 100.0 : -100.0;
    for (int i = 0; i < 4; i++) {
        wh[0] = w1; wh[1] = w2; wh[2] = w3; wh[3] = w4;
        bl[0] = b1; bl[1] = b2; bl[2] = b3; bl[3] = b4;

        if (turn) {  // 흑 차례
            ori = bl[i];
            moved = 0;
            caught = 0;
            if (ori == 30) continue;
            for (int j = 0; j < 4; j++) {
                if (bl[j] == ori && (bl[j] || moved == 0)) {
                    bl[j] = move[ori][r];
                    moved++;
                }
                if (wh[j] == move[ori][r] && wh[j]) {
                    wh[j] = 0;
                    caught = 1;
                }
            }

            cur = bef(wh[0], wh[1], wh[2], wh[3], bl[0], bl[1], bl[2], bl[3], (r >= 4 || caught), d - 1, alpha, beta);
            res = res > cur ? cur : res;
            beta = beta > res ? res : beta;
        } else {  // 백 차례
            ori = wh[i];
            caught = 0;
            if (ori == 30) continue;
            for (int j = 0; j < 4; j++) {
                if (wh[j] == ori && (wh[j] || moved == 0)) {
                    wh[j] = move[ori][r];
                    moved++;
                }
                if (bl[j] == move[ori][r] && bl[j]) {
                    bl[j] = 0;
                    caught = 1;
                }
            }

            cur = bef(wh[0], wh[1], wh[2], wh[3], bl[0], bl[1], bl[2], bl[3], !(r >= 4 || caught), d - 1, alpha, beta);
            res = res > cur ? res : cur;
            alpha = alpha > res ? alpha : res;
        }
        if (alpha >= beta) break;
    }

    return clip(res);
}

int main() {
    for (int i = 0; i < 1000; i++) {
        printf("%f ", bef(0, 0, 0, 0, 0, 0, 0, 0, 0, 6, -100000.0, 100000.0));
    }
    return 0;
}